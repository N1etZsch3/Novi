# 1.1 用户与AI设定管理接口文档

## 1. 用户账号管理 (User Account)

### 1.1 用户注册 (Register)
> **注意**: 当前处于内部测试期间，注册接口暂不开放，直接返回错误提示。

- **接口地址**: `/api/v1/users/register`
- **请求方式**: `POST`
- **Content-Type**: `application/json`

#### 请求参数 (RegistrationRequest)
| 字段名 | 类型 | 必填 | 说明 | 限制 |
| :--- | :--- | :--- | :--- | :--- |
| username | string | 是 | 用户名 | 长度 4-20 |
| nickname | string | 否 | 昵称 | 长度 max 20 |
| password | string | 是 | 密码 | 长度 8-30，需包含大小写字母、数字及特殊字符 |
| email | string | 是 | 邮箱 | 需符合邮箱格式 |

#### 响应结果 (Result)
- **成功**: `code=200` (目前不可达)
- **失败**: `code=500`, `message="内部测试期间，暂不开放注册。请联系管理员获取账号。"`

---

### 1.2 用户登录 (Login)

- **接口地址**: `/api/v1/users/login`
- **请求方式**: `POST`
- **Content-Type**: `application/json`

#### 请求参数 (LoginRequest)
| 字段名 | 类型 | 必填 | 说明 |
| :--- | :--- | :--- | :--- |
| username | string | 是 | 用户名 |
| password | string | 是 | 密码 |

#### 响应结果 (Result<LoginRespond>)
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiJ9...",
    "userId": 1001
  }
}
```

---

### 1.3 获取当前用户资料 (Get Current User)

- **接口地址**: `/api/v1/users/me`
- **请求方式**: `GET`
- **Header**: `Authorization: <token>`

#### 响应结果 (Result<UserProfileDto>)
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1001,
    "username": "novi_user",
    "nickname": "NoviUser",
    "email": "user@example.com",
    "createdAt": "2023-10-01T12:00:00",
    "updatedAt": "2023-10-05T15:30:00"
  }
}
```

---

### 1.4 更新当前用户资料 (Update Current User)

- **接口地址**: `/api/v1/users/me`
- **请求方式**: `PUT`
- **Header**: `Authorization: <token>`
- **Content-Type**: `application/json`

#### 请求参数 (UserProfileUpdateRequest)
| 字段名 | 类型 | 必填 | 说明 | 限制 |
| :--- | :--- | :--- | :--- | :--- |
| nickname | string | 否 | 新昵称 | 长度 max 20 |
| email | string | 否 | 新邮箱 | 邮箱格式 |
| newPassword | string | 否 | 新密码 | 长度 8-30 |
| currentPassword | string | 否 | 当前密码 | 修改敏感信息(如密码)时可能需要 |

#### 响应结果 (Result<UserProfileDto>)
返回更新后的完整用户信息。

---

## 2. AI 设定管理 (AI Preferences)

### 2.1 获取 AI 设定 (Get Settings)

- **接口地址**: `/api/v1/preferences`
- **请求方式**: `GET`
- **Header**: `Authorization: <token>`

#### 响应结果 (Result<NoviPersonaSettings>)
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "personalityMode": "default",
    "userAddressName": "主人",
    "toneStyle": "normal",
    "language": "zh_CN"
  }
}
```

### 2.2 更新 AI 设定 (Update Settings)

- **接口地址**: `/api/v1/preferences`
- **请求方式**: `PUT`
- **Header**: `Authorization: <token>`
- **Content-Type**: `application/json`

#### 请求参数 (NoviPersonaSettings)
| 字段名 | 类型 | 必填 | 说明 | 可选值 |
| :--- | :--- | :--- | :--- | :--- |
| personalityMode | string | 否 | 核心性格模式 | "default", "witty", "gentle", "tsundere", "professional" |
| userAddressName | string | 否 | Novi 对用户的称呼 | 任意字符串 |
| toneStyle | string | 否 | 语气风格 | "normal", "emoji_heavy", "concise", "verbose" |
| language | string | 否 | 回复语言限制 | null (自动), "zh_CN", "en_US" |

#### 响应结果 (Result<NoviPersonaSettings>)
返回更新后的设定。

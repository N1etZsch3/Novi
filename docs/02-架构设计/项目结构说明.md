# Novi é¡¹ç›®ç»“æ„è¯´æ˜æ–‡æ¡£

## ğŸ“‚ é¡¹ç›®æ ¹ç›®å½•ç»“æ„

```
Novi/
â”œâ”€â”€ .env                        # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ .git/                       # Gitç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€ .gitignore                  # Gitå¿½ç•¥è§„åˆ™
â”œâ”€â”€ .idea/                      # IntelliJ IDEAé…ç½®
â”œâ”€â”€ .mvn/                       # Maven Wrapperé…ç½®
â”œâ”€â”€ docs/                       # é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ 01-å…¥é—¨æŒ‡å—/
â”‚   â”œâ”€â”€ 02-æ¶æ„è®¾è®¡/
â”‚   â”œâ”€â”€ 03-åŠŸèƒ½æ¨¡å—/
â”‚   â”œâ”€â”€ 04-APIæ–‡æ¡£/
â”‚   â””â”€â”€ 05-å…¶ä»–/
â”œâ”€â”€ logs/                       # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ novi-ai-config/             # AIé…ç½®æ¨¡å—
â”œâ”€â”€ novi-chat/                  # èŠå¤©æ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ novi-common/                # å…¬å…±æ¨¡å—
â”œâ”€â”€ novi-question/              # å‡ºé¢˜æ¨¡å—
â”œâ”€â”€ novi-user/                  # ç”¨æˆ·æ¨¡å—
â”œâ”€â”€ novi-view/                  # å‰ç«¯è§†å›¾æ¨¡å—
â”œâ”€â”€ novi-web/                   # Webå¯åŠ¨æ¨¡å—
â”œâ”€â”€ pom.xml                     # çˆ¶å·¥ç¨‹Mavené…ç½®
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ—‚ï¸ æ¨¡å—ç»“æ„è¯´æ˜

### 1. novi-common (å…¬å…±æ¨¡å—)
åŸºç¡€ä¾èµ–ã€å·¥å…·ç±»ã€é€šç”¨DTO/Entityã€å¼‚å¸¸å¤„ç†ç­‰ã€‚è¢«å…¶ä»–æ‰€æœ‰æ¨¡å—ä¾èµ–ã€‚

```
novi-common/
â”œâ”€â”€ src/main/java/com/n1etzsch3/novi/common/
â”‚   â”œâ”€â”€ config/                 # é€šç”¨é…ç½® (MyBatisPlusç­‰)
â”‚   â”œâ”€â”€ exception/              # å…¨å±€å¼‚å¸¸å®šä¹‰
â”‚   â”œâ”€â”€ pojo/                   # é€šç”¨POJO
â”‚   â”‚   â”œâ”€â”€ dto/                # é€šç”¨DTO (Resultç­‰)
â”‚   â”‚   â””â”€â”€ entity/             # é€šç”¨å®ä½“åŸºç±»
â”‚   â””â”€â”€ utils/                  # å·¥å…·ç±» (JwtUtilç­‰)
```

### 2. novi-user (ç”¨æˆ·æ¨¡å—)
è´Ÿè´£ç”¨æˆ·è´¦å·ã€ä¸ªäººèµ„æ–™ã€åå¥½è®¾ç½®ç­‰åŠŸèƒ½ã€‚

```
novi-user/
â”œâ”€â”€ src/main/java/com/n1etzsch3/novi/user/
â”‚   â”œâ”€â”€ mapper/                 # ç”¨æˆ·ç›¸å…³Mapper
â”‚   â”œâ”€â”€ pojo/                   # ç”¨æˆ·ç›¸å…³POJO
â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â””â”€â”€ entity/
â”‚   â””â”€â”€ service/                # ç”¨æˆ·ç›¸å…³Service
```

### 3. novi-ai-config (AIé…ç½®æ¨¡å—)
è´Ÿè´£AIæ¨¡å‹é…ç½®ã€æç¤ºè¯é…ç½®çš„ç®¡ç†ã€‚

```
novi-ai-config/
â”œâ”€â”€ src/main/java/com/n1etzsch3/novi/aiconfig/
â”‚   â”œâ”€â”€ factory/                # åŠ¨æ€æ¨¡å‹å·¥å‚
â”‚   â”œâ”€â”€ mapper/                 # é…ç½®ç›¸å…³Mapper
â”‚   â”œâ”€â”€ pojo/                   # é…ç½®ç›¸å…³POJO
â”‚   â””â”€â”€ service/                # é…ç½®ç›¸å…³Service
```

### 4. novi-chat (èŠå¤©æ ¸å¿ƒæ¨¡å—)
è´Ÿè´£AIèŠå¤©ã€ä¼šè¯ç®¡ç†ã€è®°å¿†å­˜å‚¨ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

```
novi-chat/
â”œâ”€â”€ src/main/java/com/n1etzsch3/novi/chat/
â”‚   â”œâ”€â”€ config/                 # èŠå¤©ç›¸å…³é…ç½®
â”‚   â”œâ”€â”€ mapper/                 # èŠå¤©ç›¸å…³Mapper
â”‚   â”œâ”€â”€ pojo/                   # èŠå¤©ç›¸å…³POJO
â”‚   â”œâ”€â”€ repository/             # Spring AI ChatMemoryå®ç°
â”‚   â””â”€â”€ service/                # èŠå¤©ç›¸å…³Service
```

### 5. novi-question (å‡ºé¢˜æ¨¡å—)
è´Ÿè´£AIå‡ºé¢˜ã€å†å²è®°å½•ç®¡ç†ç­‰åŠŸèƒ½ã€‚

```
novi-question/
â”œâ”€â”€ src/main/java/com/n1etzsch3/novi/question/
â”‚   â”œâ”€â”€ mapper/                 # å‡ºé¢˜ç›¸å…³Mapper
â”‚   â”œâ”€â”€ pojo/                   # å‡ºé¢˜ç›¸å…³POJO
â”‚   â””â”€â”€ service/                # å‡ºé¢˜ç›¸å…³Service
```

### 6. novi-view (å‰ç«¯è§†å›¾æ¨¡å—)
å­˜æ”¾é™æ€èµ„æºå’ŒHTMLé¡µé¢ã€‚

```
novi-view/
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ static/                 # é™æ€èµ„æº (CSS, JS)
â”‚   â””â”€â”€ templates/              # HTMLæ¨¡æ¿
```

### 7. novi-web (Webå¯åŠ¨æ¨¡å—)
é¡¹ç›®çš„å…¥å£ï¼ŒåŒ…å«Controllerå±‚å’Œå¯åŠ¨ç±»ã€‚ä¾èµ–ä»¥ä¸Šæ‰€æœ‰æ¨¡å—ã€‚

```
novi-web/
â”œâ”€â”€ src/main/java/com/n1etzsch3/novi/
â”‚   â”œâ”€â”€ NoviApplication.java    # å¯åŠ¨ç±»
â”‚   â””â”€â”€ controller/             # æ‰€æœ‰Controller
â””â”€â”€ src/main/resources/
    â”œâ”€â”€ application.properties  # ä¸»é…ç½®æ–‡ä»¶
    â””â”€â”€ static/                 # SQLåˆå§‹åŒ–è„šæœ¬
```

## ğŸ§ª æµ‹è¯•ä»£ç ç»“æ„

æµ‹è¯•ä»£ç ä½äºå„æ¨¡å—çš„ `src/test/java` ç›®å½•ä¸‹ï¼Œä¸»è¦é›†ä¸­åœ¨ `novi-web` æ¨¡å—è¿›è¡Œé›†æˆæµ‹è¯•ã€‚

## ğŸ“‹ å„å±‚èŒè´£è¯´æ˜

### 1. Controller å±‚
- **èŒè´£**ï¼šå¤„ç†HTTPè¯·æ±‚å’Œå“åº”
- **ç‰¹ç‚¹**ï¼š
  - åªåšå‚æ•°éªŒè¯å’Œè°ƒç”¨Service
  - ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
  - ç»Ÿä¸€ä½¿ç”¨ `Result` å°è£…å“åº”
  - ä½¿ç”¨ `@RestController` æ³¨è§£

### 2. Service å±‚
- **èŒè´£**ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘å¤„ç†
- **ç‰¹ç‚¹**ï¼š
  - äº‹åŠ¡ç®¡ç†
  - ä¸šåŠ¡è§„åˆ™å®ç°
  - è·¨å±‚åè°ƒï¼ˆè°ƒç”¨å¤šä¸ªMapperï¼‰
  - æ¥å£ä¸å®ç°åˆ†ç¦»

### 3. Mapper å±‚
- **èŒè´£**ï¼šæ•°æ®åº“è®¿é—®
- **ç‰¹ç‚¹**ï¼š
  - ä½¿ç”¨ MyBatis-Plus
  - ç»§æ‰¿ `BaseMapper<T>`
  - è‡ªå®šä¹‰SQLä½¿ç”¨æ³¨è§£æˆ–XML

### 4. Domain å±‚
- **PO (Persistent Object)**ï¼šå¯¹åº”æ•°æ®åº“è¡¨
- **DTO (Data Transfer Object)**ï¼šAPIä¼ è¾“å¯¹è±¡

### 5. Config å±‚
- **èŒè´£**ï¼šSpringé…ç½®ç±»
- **å†…å®¹**ï¼š
  - Beané…ç½®
  - æ‹¦æˆªå™¨æ³¨å†Œ
  - ç¬¬ä¸‰æ–¹ç»„ä»¶åˆå§‹åŒ–

## ğŸ”„ æ•°æ®æµå‘

```
è¯·æ±‚æµå‘ï¼š
Client â†’ Controller â†’ Service â†’ Mapper â†’ Database

å“åº”æµå‘ï¼š
Database â†’ Mapper â†’ Service â†’ Controller â†’ Client
```

## ğŸ“¦ ä¾èµ–ç®¡ç†ï¼ˆpom.xmlï¼‰

### æ ¸å¿ƒä¾èµ–

| ä¾èµ– | ç”¨é€” |
|------|------|
| spring-boot-starter-web | Webåº”ç”¨åŸºç¡€ |
| spring-ai-starter-model-openai | Spring AIé›†æˆ |
| mybatis-plus-boot-starter | MyBatis-Plus ORM |
| mysql-connector-j | MySQLé©±åŠ¨ |
| jjwt | JWTè®¤è¯ |
| spring-security-crypto | å¯†ç åŠ å¯† |
| lombok | ç®€åŒ–ä»£ç  |

## ğŸ¯ è®¾è®¡æ¨¡å¼åº”ç”¨

### 1. å·¥å‚æ¨¡å¼
- `DynamicChatModelFactory`ï¼šåŠ¨æ€åˆ›å»ºChatClient

### 2. å•ä¾‹æ¨¡å¼
- Spring Beané»˜è®¤å•ä¾‹

### 3. æ¨¡æ¿æ–¹æ³•æ¨¡å¼
- MyBatis-Plusçš„BaseMapper

### 4. ç­–ç•¥æ¨¡å¼
- ä¸åŒAIæ¨¡å‹çš„åˆ‡æ¢

### 5. è§‚å¯Ÿè€…æ¨¡å¼
- Springäº‹ä»¶æœºåˆ¶

## ğŸ“ å‘½åè§„èŒƒ

### ç±»å‘½å
- Controller: `xxxController`
- Serviceæ¥å£: `xxxService`
- Serviceå®ç°: `xxxServiceImpl`
- Mapper: `xxxMapper`
- å®ä½“ç±»: å®ä½“åç§°ï¼ˆå¦‚ `UserAccount`ï¼‰
- DTO: `xxxRequest`/`xxxResponse`

### æ–¹æ³•å‘½å
- æŸ¥è¯¢: `get`/`find`/`list`
- æ–°å¢: `add`/`create`/`save`
- ä¿®æ”¹: `update`/`modify`
- åˆ é™¤: `delete`/`remove`

## ğŸ” å®‰å…¨æœºåˆ¶

### è®¤è¯æµç¨‹
1. ç”¨æˆ·ç™»å½• â†’ è¿”å›JWT Token
2. è¯·æ±‚æºå¸¦Token â†’ æ‹¦æˆªå™¨éªŒè¯
3. æå–ç”¨æˆ·ä¿¡æ¯ â†’ å­˜å…¥ThreadLocal
4. ä¸šåŠ¡å¤„ç† â†’ ä»ThreadLocalè·å–ç”¨æˆ·

### æƒé™æ§åˆ¶
- ä½¿ç”¨æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†
- éƒ¨åˆ†æ¥å£éœ€è¦ç™»å½•
- ç®¡ç†å‘˜æ¥å£å•ç‹¬éªŒè¯

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®æ¦‚è§ˆ](file:///C:/Users/35666/.gemini/antigravity/brain/774ebe23-99e1-46d9-a3e1-52263e77b58e/é¡¹ç›®æ¦‚è§ˆ.md)
- [æ•°æ®åº“è®¾è®¡æ–‡æ¡£](file:///C:/Users/35666/.gemini/antigravity/brain/774ebe23-99e1-46d9-a3e1-52263e77b58e/æ•°æ®åº“è®¾è®¡æ–‡æ¡£.md)
